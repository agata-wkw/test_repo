clear all
clc

spm('defaults', 'eeg');

F.Root = '/Users/agatawkw/Documents/_DATA/Cholinergic_Data/EEG/';

F.Subj = {'VP01_AO16','VP02_HA30','VP04_NU09','VP05_AOE26',...
    'VP07_IR17','VP08_LU03','VP09_AO09','VP10_AE15','VP11_TC12',...
    'VP12_UEO36','VP13_AE39','VP14_EU09','VP15_AA11','VP16_HU39',...
    'VP17_AA21','VP18_IH33','VP19_TR18','VP20_JL16','VP21_IA12',...
    'VP22_AC21','VP23_AA23','VP24_AE15'};

Elec = 1:64;
Stim = {'Load2', 'Load4', 'Load6'};

run = 1;

for i0 = 5%:length(F.Subj)
    
    for s = 1:length(Stim)
        
        F.SubjPath = [F.Root F.Subj{i0} '/Run' num2str(run) '/'];
        cd(F.SubjPath)
        
        
        S = [];
        FileName = ['Mpostica_re' Stim{s} '_ff_' F.Subj{i0}];
        S.dataset = [F.SubjPath FileName '.set'];
        S.continuous = 1;
        % S.timewindow = [0.002 134.558];
        S.checkboundary = 0;
        
        S.channels = {
            'Fp1'
            'Fp2'
            'F3'
            'F4'
            'C3'
            'C4'
            'P3'
            'P4'
            'O1'
            'O2'
            'F7'
            'F8'
            'T7'
            'T8'
            'P7'
            'P8'
            'Fz'
            'Cz'
            'Pz'
            'Oz'
            'FC1'
            'FC2'
            'CP1'
            'CP2'
            'FC5'
            'FC6'
            'CP5'
            'CP6'
            'F1'
            'F2'
            'C1'
            'C2'
            'P1'
            'P2'
            'AF3'
            'AF4'
            'FC3'
            'FC4'
            'CP3'
            'CP4'
            'PO3'
            'PO4'
            'F5'
            'F6'
            'C5'
            'C6'
            'P5'
            'P6'
            'AF7'
            'AF8'
            'FT7'
            'FT8'
            'TP7'
            'TP8'
            'PO7'
            'PO8'
            'Fpz'
            'AFz'
            'CPz'
            'POz'
            };
        
        S.inputformat = [];
        S.save = 0;
        S.outfile = ['spm8_' FileName];
        S.blocksize = 3276800;
        S.usetrials = 1;
        S.datatype = 'float32-le';
        S.eventpadding = 0;
        S.saveorigheader = 0;
        S.conditionlabel = {'Undefined'};
        D = spm_eeg_convert(S);
        
        
        S = [];
        S.task = 'settype';
        S.D = [F.SubjPath 'spm8_' FileName '.mat'];
        S.ind = [1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60];
        S.type = 'EEG';
        S.save = 1;
        D = spm_eeg_prep(S);
        
        
        S = [];
        S.D = [F.SubjPath 'spm8_' FileName '.mat'];
        S.task = 'defaulteegsens';
        S.save = 1;
        D = spm_eeg_prep(S);
        
        
        S = [];
        S.task = 'setcoor2d';
        S.D = [F.SubjPath 'spm8_' FileName '.mat'];
        S.xy = [0.358127431070432 0.63115333565553 0.319499558310764 0.684446454131226 0.295640676509763 0.70801035314695 0.337261391153001 0.658765804468392 0.381476047145341 0.599476237529535 0.121753409066311 0.878951869887076 0.05 0.95 0.176983444035271 0.810437806844084 0.498387742743428 0.498366895939447 0.496027125746896 0.490099574981175 0.402418214252759 0.597352645199803 0.407784984615512 0.593172800977718 0.178452330461275 0.826079267890217 0.204129030986282 0.795911344188124 0.412094935710624 0.590119958154716 0.402232139889891 0.598675341202977 0.419107072168501 0.57877084537302 0.364687127498288 0.633966624967236 0.296722753529597 0.706962412478808 0.31059947251063 0.69078343536388 0.374805341575767 0.611863922610018 0.22058671288775 0.784927979314371 0.176774133670791 0.826759976212305 0.255936320417754 0.735389719899426 0.230361291206221 0.764761267196509 0.0551811363296929 0.947194362550941 0.0952050213281217 0.898334363412286 0.274933610032685 0.708438648401534 0.494127551616874 0.497096812715531 0.497486874012439 0.493654015274171
            0.942196229035559 0.947618276783022 0.704424694488413 0.710296356320055 0.453875628701106 0.44862335769459 0.239844363089218 0.234996405039993 0.0562045097709736 0.05 0.769214080883736 0.772674854191377 0.429689906009453 0.41905612863268 0.168615510965359 0.152974612749631 0.683559974525103 0.460826275730699 0.261591865430624 0.0515396939544365 0.569442506218161 0.569722703171172 0.359271877535109 0.355153334441709 0.58875055296062 0.586645863133924 0.317175320586432 0.309891344186973 0.687606465621836 0.690548361884121 0.45922323363501 0.45607978063091 0.256774163824313 0.25626181362887 0.833858962361202 0.8338795270412 0.577528167056534 0.576287810611184 0.343517113290689 0.337223432145186 0.143752119996455 0.134920601441252 0.732526572749312 0.734756791889304 0.442920103194823 0.43700220583405 0.209291828714152 0.196886412310761 0.882774888974954 0.889992316609759 0.607031739613079 0.605290871995664 0.285018881323545 0.268276256762212 0.094508109070669 0.0829424488313281 0.95 0.812153573415477 0.361358078548764 0.155495358925702];
        
        S.label = {
            'Fp1'
            'Fp2'
            'F3'
            'F4'
            'C3'
            'C4'
            'P3'
            'P4'
            'O1'
            'O2'
            'F7'
            'F8'
            'T7'
            'T8'
            'P7'
            'P8'
            'Fz'
            'Cz'
            'Pz'
            'Oz'
            'FC1'
            'FC2'
            'CP1'
            'CP2'
            'FC5'
            'FC6'
            'CP5'
            'CP6'
            'F1'
            'F2'
            'C1'
            'C2'
            'P1'
            'P2'
            'AF3'
            'AF4'
            'FC3'
            'FC4'
            'CP3'
            'CP4'
            'PO3'
            'PO4'
            'F5'
            'F6'
            'C5'
            'C6'
            'P5'
            'P6'
            'AF7'
            'AF8'
            'FT7'
            'FT8'
            'TP7'
            'TP8'
            'PO7'
            'PO8'
            'Fpz'
            'AFz'
            'CPz'
            'POz'
            }';
        
        S.save = 1;
        D = spm_eeg_prep(S);
        
        S = [];
        S.D = [F.SubjPath 'spm8_' FileName '.mat'];
        S.fsample = 500;
        S.timeonset = 0;
        S.bc = 1;
        S.inputformat = [];
        S.pretrig = -1000;
        S.posttrig = 6080;
        S.trialdef.conditionlabel = Stim{s};
        S.trialdef.eventtype = 'Stimulus';
        S.trialdef.eventvalue = {'S 22'};
        S.reviewtrials = 0;
        S.save = 0;
        S.epochinfo.padding = 0;
        D = spm_eeg_epochs(S);
        
    end
end
